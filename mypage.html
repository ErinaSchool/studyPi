<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- -----------firebase CDN------------- -->
    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-database.js"></script>
    <script src="firebase.js"></script>
</head>

<body>
    <div id="logout-button">
        <a>ログアウト</a>
    </div>
    <div>
        <a href="index.html">ホーム</a>
    </div>
    <script>
        // ログインしているか判定
        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
                console.log(user.uid)
            } else {
                console.log('No user is signed in.')
            }
        });
        // ログアウトの処理
        document.getElementById("logout-button").onclick = function () {
            firebase.auth().signOut().then(function () {
                location.href = './login.html';
            }).catch(function (error) {
                console.log(error)
            });
        };
        // realtime databaseの処理
        var database = firebase.database();
        // firebaseに記録を書き込む関数
        function writeRecordData(userId, term) {
            firebase.database().ref('records/' + userId + '/' + Date.now()).set({
                term: term
            });
        }
        // firebaseからuserの記録を持ってくる関数
        // ここにページが読み込まれたら読み込む処理を書く
        window.onload = function readRecordData() {
            firebase.auth().onAuthStateChanged(function (user) {
                firebase.database().ref('/records/' + user.uid).once('value').then(function (snapshot) {
                    var data = snapshot.val()
                    console.log(data)
                });
            });
        }
        // データ
    </script>
</body>

</html>